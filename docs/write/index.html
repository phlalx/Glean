<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<title data-react-helmet="true">Writing data to Glean | Glean</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://glean.software/docs/write/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Writing data to Glean | Glean"><meta data-react-helmet="true" name="description" content="This page describes the various ways in which data gets into Glean."><meta data-react-helmet="true" property="og:description" content="This page describes the various ways in which data gets into Glean."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://glean.software/docs/write/"><link data-react-helmet="true" rel="alternate" href="https://glean.software/docs/write/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://glean.software/docs/write/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.86494598.css">
<link rel="preload" href="/assets/js/runtime~main.27558fdf.js" as="script">
<link rel="preload" href="/assets/js/main.4dd40865.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" style="background-color:#20232a;color:#fff" role="banner"><div class="announcementBarContent_6uhP">Support Ukraine ðŸ‡ºðŸ‡¦ <a target="_blank" rel="noopener noreferrer" href="https://opensource.fb.com/support-ukraine"> Help Provide Humanitarian Aid to Ukraine</a>.</div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title">Glean</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction/">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebookincubator/glean" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">User Guide</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Schemas</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Querying</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/derived/">Derived Predicates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/databases/">Glean Databases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/write/">Writing data to Glean</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/running/">Running the Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/shell/">Using the Shell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/server/">Running the Glean Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cli/">The Glean CLI tool</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Indexers</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_XoVD"><div class="docItemContainer_6jsP"><article><header><h1 class="docTitle_ft6A">Writing data to Glean</h1></header><div class="markdown"><p>This page describes the various ways in which data gets into Glean.</p><p>There are two main methods for creating a DB. Repo-wide indexing jobs
which require multiple workers and have dependent tasks are managed by
the server, while simple one-off DB creation can be performed
independently by a single client.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="client-driven-writing">Client-driven writing<a aria-hidden="true" class="hash-link" href="#client-driven-writing" title="Direct link to heading">â€‹</a></h2><p>A database can be created by a client using any of these methods:</p><ol><li>Programmatically, using one of the APIs listed in <a href="#apis-for-writing">APIs for Writing</a>.</li><li>On the command line: invoke the <code>glean</code> command-line tool to send data in JSON format, see <a href="#creating-a-database-usin"> Creating a database using the command line</a>.</li><li>In the shell, use <code>glean shell --db-root=&lt;dir&gt;</code> and then use the command <code>:load</code> to create a DB from a JSON file. See <a href="#loading-a-db-from-json-i"> Loading a DB from JSON in the shell</a>.</li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="server-driven-writing">Server-driven writing<a aria-hidden="true" class="hash-link" href="#server-driven-writing" title="Direct link to heading">â€‹</a></h2><p>Large indexing jobs are coordinated by the server, using a <em>recipe</em> to
define the various tasks and the dependencies between them.  Recipes
are defined in the recipes configuration; see the <code>--recipe-config</code>
option in <a href="/docs/running/#common-options">Common options</a>.</p><p>The job proceeds as follows:</p><ul><li><p>An indexing job is started by calling the server&#x27;s <code>kickOff</code> Thrift
method. This creates a work queue of tasks on the server.</p></li><li><p>Clients obtain tasks from the server by calling <code>getWork</code>. Tasks may
have dependencies between them, so the server won&#x27;t hand out a task
until its dependencies are complete.</p></li><li><p>When all tasks are done, the server marks the database as complete.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="apis-for-writing">APIs for writing<a aria-hidden="true" class="hash-link" href="#apis-for-writing" title="Direct link to heading">â€‹</a></h2><ul><li>The Haskell API for writing<ul><li>Example: <a href="https://github.com/facebookincubator/Glean/tree/master/glean/client/hs/example/ExampleWriter.hs">glean/client/hs/example/ExampleWriter.hs</a></li></ul></li></ul><p>If none of the above work for you, the Thrift API enable basic write
access to the database.</p><ul><li><code>kickOff</code> can be used to create a new DB</li><li><code>sendJsonBatch</code> is for sending facts in JSON-serialized form</li><li><code>finishBatch</code> exposes the result of a previously sent JSON batch</li><li><code>workFinished</code> closes a DB</li></ul><p>A rough outline of a client looks like:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">glean = make_glean_thrift_client()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">db_handle = make_uuid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">glean.kickOff(my_repo, KickOffFill(writeHandle=db_handle))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for json_batch in json_batches:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    handle = glean.sendJsonBatch(json_batch)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    result = glean.finishBatch(handle)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # handle result</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">glean.workFinished(my_repo, db_handle, success_or_failure)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="writing-from-the-command-line">Writing from the command line<a aria-hidden="true" class="hash-link" href="#writing-from-the-command-line" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="json-format">JSON format<a aria-hidden="true" class="hash-link" href="#json-format" title="Direct link to heading">â€‹</a></h3><p>The JSON format for Glean data is described in <a href="/docs/schema/thrift/">Thrift and JSON</a>.</p><p>Here&#x27;s an example of JSON data for writing to Glean:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { &quot;predicate&quot;: &quot;cxx1.Name.1&quot;,          # define facts for cxx1.Name.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;facts&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      { &quot;id&quot;: 1, &quot;key&quot;: &quot;abc&quot; },         # define a fact with id 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      { &quot;id&quot;: 2, &quot;key&quot;: &quot;def&quot; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { &quot;predicate&quot;: &quot;cxx1.FunctionName.1&quot;,  # define facts for cxx1.FunctionName.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;facts&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      { &quot;id&quot;: 3,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;key&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot;: { &quot;id&quot;: 1 }}}          # reference to fact with id 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  { &quot;predicate&quot;: &quot;cxx1.FunctionQName.1&quot;, # define facts for cxx1.FunctionQName.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;facts&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      { &quot;key&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;name&quot;: 3,                       # 3 is shorthand for { &quot;id&quot;: 3 }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;scope&quot;: { &quot;global_&quot;: {} } } },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      { &quot;key&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;name&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;key&quot;: {                       # define a nested fact directly</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;name&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              &quot;key&quot;: &quot;ghi&quot; }}},         # another nested fact</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;scope&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;namespace_&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;key&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              &quot;name&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;key&quot;: &quot;std&quot; }}}}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The rules of the game are:</p><ul><li>Predicate names must include versions, i.e. <code>cxx1.Name.1</code> rather than <code>cxx1.Name</code>.</li><li>The <code>id</code> field when defining a fact is optional. The <code>id</code> numbers in the input file will <em>not</em> be the final <code>id</code> numbers assigned to the facts in the database.</li><li>There are no restrictions on <code>id</code> values (any 64-bit integer will do) but an <code>id</code> value may not be reused within a file.</li><li>Later facts may refer to earlier ones using either <code>{ &quot;id&quot;: N }</code> or just <code>N</code>.</li><li>It is only possible to refer to <code>id</code>s from facts in the same file, if you are writing multiple files using <code>glean write</code> or via the <code>sendJsonBatch</code> API.</li><li>a nested facts can be defined inline, instead of defining it with an <code>id</code> first and then referencing it.</li><li>an inline nested fact can be given an <code>id</code> and referred to later.</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="loading-a-db-from-json-in-the-shell">Loading a DB from JSON in the shell<a aria-hidden="true" class="hash-link" href="#loading-a-db-from-json-in-the-shell" title="Direct link to heading">â€‹</a></h3><p>The shell is useful for experimenting with creating a DB from JSON data directly. Let&#x27;s try loading the data above into a DB in the shell:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ mkdir /tmp/glean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ glean shell --db-root /tmp/glean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Glean Shell, dev mode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type :help for help.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">no fbsource database availabe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; :load test/0 /home/smarlow/test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">I0514 01:19:37.137109 3566745 Work.hs:184] test/16: database complete</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Let&#x27;s see what facts we loaded:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">test&gt; :stat</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  count: 72</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  size:  5988</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cxx1.FunctionName.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  count: 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  size:  66</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cxx1.FunctionQName.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  count: 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  size:  70</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cxx1.Name.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  count: 4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  size:  148</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cxx1.NamespaceQName.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  count: 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  size:  35</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">test&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Note that there were 4 <code>cxx1.Name.1</code> facts - some of those were defined as inline nested facts in the JSON. We can query them all:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">test&gt; cxx1.Name _</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">4 results, 1 queries, 4 facts, 0.22ms, 44296 bytes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{ &quot;id&quot;: 1096, &quot;key&quot;: &quot;abc&quot; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{ &quot;id&quot;: 1097, &quot;key&quot;: &quot;def&quot; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{ &quot;id&quot;: 1100, &quot;key&quot;: &quot;ghi&quot; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{ &quot;id&quot;: 1102, &quot;key&quot;: &quot;std&quot; }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Note that the <code>id</code> values here do not correspond to the <code>id</code> values in the input file.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="creating-a-database-using-the-command-line">Creating a database using the command line<a aria-hidden="true" class="hash-link" href="#creating-a-database-using-the-command-line" title="Direct link to heading">â€‹</a></h3><p>The <code>glean</code> command-line tool can be used to create a database directly on the server.</p><p>To create a database from a single file of JSON facts:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">glean create --service &lt;write-server&gt; --finish --repo &lt;name&gt;/&lt;hash&gt; &lt;filename&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>where</p><ul><li><code>&lt;write-server&gt;</code> is the <code>host:port</code> of the Glean server</li></ul><ul><li><code>&lt;name&gt;</code> is the name for your DB. For indexing repositories we normally use the name of the repository, but it&#x27;s just a string, so you can use whatever you want.</li><li><code>&lt;hash&gt;</code> identifies this particular instance of your database. For repositories we normally use the revision hash, but, again, it&#x27;s just a string.</li><li><code>&lt;filename&gt;</code> the file containing the JSON facts.</li></ul><p>If the file is more than, say, 100MB, this operation will probably time out sending the data to the server. To send large amounts of data you need to batch it up into multiple files, and then send it like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">glean create --service &lt;write-server&gt; --repo &lt;name&gt;/&lt;hash&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">glean write --service &lt;write-server&gt; --repo &lt;name&gt;/&lt;hash&gt; &lt;filename1&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">glean write --service &lt;write-server&gt; --repo &lt;name&gt;/&lt;hash&gt; &lt;filename2&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">glean finish --service &lt;write-server&gt; --repo &lt;name&gt;/&lt;hash&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To find out if your DB made it:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">glean shell --service &lt;write-server&gt; :list</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This will list the DBs available on the write server.</p><div></div><div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebookincubator/Glean/tree/main/glean/website/docs/write.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/databases/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Glean Databases</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/running/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Running the Tools<!-- --> Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#client-driven-writing" class="table-of-contents__link toc-highlight">Client-driven writing</a></li><li><a href="#server-driven-writing" class="table-of-contents__link toc-highlight">Server-driven writing</a></li><li><a href="#apis-for-writing" class="table-of-contents__link toc-highlight">APIs for writing</a></li><li><a href="#writing-from-the-command-line" class="table-of-contents__link toc-highlight">Writing from the command line</a><ul><li><a href="#json-format" class="table-of-contents__link toc-highlight">JSON format</a></li><li><a href="#loading-a-db-from-json-in-the-shell" class="table-of-contents__link toc-highlight">Loading a DB from JSON in the shell</a></li><li><a href="#creating-a-database-using-the-command-line" class="table-of-contents__link toc-highlight">Creating a database using the command line</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/">Getting Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/MetaOpenSource" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebookincubator/glean" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_SRtH"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2022 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.27558fdf.js"></script>
<script src="/assets/js/main.4dd40865.js"></script>
</body>
</html>