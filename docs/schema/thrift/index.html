<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<title data-react-helmet="true">Thrift and JSON | Glean</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://glean.software/docs/schema/thrift/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Thrift and JSON | Glean"><meta data-react-helmet="true" name="description" content="The Glean schema is automatically translated into a set of Thrift type"><meta data-react-helmet="true" property="og:description" content="The Glean schema is automatically translated into a set of Thrift type"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://glean.software/docs/schema/thrift/"><link data-react-helmet="true" rel="alternate" href="https://glean.software/docs/schema/thrift/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://glean.software/docs/schema/thrift/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.86494598.css">
<link rel="preload" href="/assets/js/runtime~main.27558fdf.js" as="script">
<link rel="preload" href="/assets/js/main.4dd40865.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" style="background-color:#20232a;color:#fff" role="banner"><div class="announcementBarContent_6uhP">Support Ukraine 🇺🇦 <a target="_blank" rel="noopener noreferrer" href="https://opensource.fb.com/support-ukraine"> Help Provide Humanitarian Aid to Ukraine</a>.</div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title">Glean</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction/">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebookincubator/glean" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">User Guide</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Schemas</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/basic/">Basic Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/types/">Built-in Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/syntax/">Syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/recursion/">Recursion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/changing/">Changing a schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/all/">The special &quot;all&quot; schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/workflow/">Workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/schema/thrift/">Thrift and JSON</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Querying</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/derived/">Derived Predicates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/databases/">Glean Databases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/write/">Writing data to Glean</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/running/">Running the Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/shell/">Using the Shell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/server/">Running the Glean Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cli/">The Glean CLI tool</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Indexers</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_XoVD"><div class="docItemContainer_6jsP"><article><header><h1 class="docTitle_ft6A">Thrift and JSON</h1></header><div class="markdown"><p>The Glean schema is automatically translated into a set of Thrift type
definitions by the <code>gen-schema</code> tool (see <a href="/docs/schema/workflow/">Workflow</a>).
These Thrift definitions can be used to work with Glean data in your
client, as native data types in whatever language you&#x27;re using, either
for querying data or for writing facts.</p><p>The Thrift types also have a JSON representation, which can be read
and written directly. When you perform queries in the
<a href="/docs/shell/">shell</a>, the results are printed as JSON-encoded Thrift;
when you <a href="/docs/write/">write data to Glean</a> it can be in the form of
JSON-encoded Thrift.</p><p>The relationship between schema types and Thrift/JSON is given by the following table:</p><table><thead><tr><th>Schema type</th><th>Thrift type</th><th>JSON</th></tr></thead><tbody><tr><td><code>nat</code></td><td><code>Nat</code> (<code>i64</code>)</td><td>123</td></tr><tr><td><code>byte</code></td><td><code>Byte</code> (<code>i8</code>)</td><td>123</td></tr><tr><td><code>string</code></td><td><code>string</code></td><td>&quot;abc&quot;</td></tr><tr><td><code>bool</code></td><td><code>bool</code></td><td><code>true</code> or <code>false</code></td></tr><tr><td><code>[byte]</code></td><td><code>binary</code></td><td>base-64 encoded string <sup>*1</sup></td></tr><tr><td><code>[T]</code></td><td><code>list&lt;T&gt;</code></td><td>[...]</td></tr><tr><td><code>{</code><br> <!-- --> <code>f₁ : T₁,</code><br> <!-- --> <code>...,</code><br> <!-- --> <code>fₙ : Tₙ</code><br><code>}</code></td><td><code>struct Foo {</code><br> <!-- --> <code>1: T₁ f₁;</code><br> <!-- --> <code>...</code><br> <!-- --> <code>n: Tₙ fₙ;</code><br><code>}</code></td><td><code>{</code><br> <!-- --> <code>&quot;f₁&quot; : q₁,</code><br> <!-- --> <code>...</code><br> <!-- --> <code>&quot;fₙ&quot; : qₙ</code><br><code>}</code></td></tr><tr><td><code>{</code><br> <!-- --> <code>f₁ : T₁ </code><code>|</code><br> <!-- --> <code>... </code><code>|</code><br> <!-- --> <code>fₙ : Tₙ</code><br><code>}</code></td><td><code>union Foo {</code><br> <!-- --> <code>1: T₁ f₁;</code><br> <!-- --> <code>...</code><br> <!-- --> <code>n: Tₙ fₙ;</code><br><code>}</code></td><td><code>{ &quot;f&quot; : t }</code><br>for one of the fields <code>f₁</code>..<code>fₙ</code></td></tr><tr><td><code>maybe T</code></td><td>In a record field:<br> <code>optional T f</code></td><td><code>f : t</code><br> if the value is present</td></tr><tr><td><code>enum {</code><br> <!-- --> <code>L₁</code><code>|</code><br> <!-- --> <code>...</code><code>|</code><br> <!-- --> <code>Lₙ</code><br><code>}</code></td><td><code>enum Foo { </code><br> <!-- --> <code>L₁ = 1,</code><br> <!-- --> <code>...</code><br> <!-- --> <code>Lₙ = n</code><br><code>}</code></td><td>the index of the value,<br> e.g. 12</td></tr><tr><td><code>predicate P : K -&gt; V</code></td><td><code>struct P {</code><br> <!-- --> <code>1: Id id</code><br> <!-- --> <code>2: optional K key</code><br> <!-- --> <code>3: optional V value</code><br><code>}</code><br>note<sup>*2</sup></td><td>refer to fact N:<br><code>N</code> or <code>{ &quot;id&quot;: N }</code><br>define a fact:<br><code>{ &quot;id&quot; : N,</code><br> <!-- --> <!-- --> <code>&quot;key&quot; : t }</code> or<br><code>{ &quot;key&quot;: t }</code> or<br><code>{ &quot;key&quot;: t,</code><br> <!-- --> <!-- --> <!-- --> <code>&quot;value&quot; : v }</code></td></tr><tr><td><code>type N = T</code></td><td>depending on T: <br><code>struct N { .. }</code><br> <code>union N {...}</code><br> <code>enum N {...}</code><br><code>typedef T N;</code></td><td>same as type T</td></tr></tbody></table><ol><li><p>The Thrift encoding of a binary field in JSON is a base-64-encoded string. However, not all Thrift implementations respect this. At the time of writing, the Python Thrift implementation doesn&#x27;t base-64-encode binary values. For this reason we provide an option in the Glean Thrift API to disable base-64 encoding for binary if your client doesn&#x27;t support it. The Glean Shell also uses this option to make it easier to work with binary.</p></li><li><p>the <code>key</code> is optional - a nested fact may be expanded in place or represented by a reference to the fact ID only. When querying Glean data the query specifies which nested facts should be expanded in the result, and when writing data to Glean using Thrift or JSON, we can optionally specify the value of nested facts inline.</p></li></ol></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebookincubator/Glean/tree/main/glean/website/docs/schema/thrift.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/schema/workflow/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->Workflow</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/query/intro/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview<!-- --> »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/">Getting Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/MetaOpenSource" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebookincubator/glean" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_SRtH"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright © 2022 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.27558fdf.js"></script>
<script src="/assets/js/main.4dd40865.js"></script>
</body>
</html>